<!DOCTYPE html>
<html lang="es">
  <head>
    <!-- Hotjar Tracking Code for https://moralesmozart.github.io/travel-platform/ -->
    <script>
        (function(h,o,t,j,a,r){
            h.hj=h.hj||function(){(h.hj.q=h.hj.q||[]).push(arguments)};
            h._hjSettings={hjid:6507380,hjsv:6};
            a=o.getElementsByTagName('head')[0];
            r=o.createElement('script');r.async=1;
            r.src=t+h._hjSettings.hjid+j+h._hjSettings.hjsv;
            a.appendChild(r);
        })(window,document,'https://static.hotjar.com/c/hotjar-','.js?sv=');
    </script>
    
    <meta charset="utf-8" />
    <link rel="icon" href="%PUBLIC_URL%/favicon.ico" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="theme-color" content="#4CAF50" />
    <meta
      name="description"
      content="Plataforma de masías catalanas - Descubre las masías más auténticas de Cataluña"
    />
    <meta name="author" content="Mozart Morales" />
    <meta name="robots" content="index, follow" />
    
    <!-- Security Headers -->
    <meta http-equiv="X-Content-Type-Options" content="nosniff" />
    <meta http-equiv="X-Frame-Options" content="DENY" />
    <meta http-equiv="X-XSS-Protection" content="1; mode=block" />
    <meta http-equiv="Referrer-Policy" content="strict-origin-when-cross-origin" />
    
    <!-- Content Security Policy -->
    <meta http-equiv="Content-Security-Policy" content="
      default-src 'self';
      script-src 'self' 'unsafe-inline' 'unsafe-eval' https://static.hotjar.com https://*.hotjar.com;
      style-src 'self' 'unsafe-inline' https://*.hotjar.com;
      img-src 'self' data: https: https://*.hotjar.com;
      font-src 'self' data: https://*.hotjar.com;
      connect-src 'self' https://*.hotjar.com wss://*.hotjar.com;
      frame-src https://*.hotjar.com;
      frame-ancestors 'none';
    " />
    
    <link rel="apple-touch-icon" href="%PUBLIC_URL%/logo192.png" />
    <link rel="manifest" href="%PUBLIC_URL%/manifest.json" />
    
    <title>Travel Platform - Masías Catalanas</title>
  </head>
  <body>
    <noscript>Necesitas habilitar JavaScript para usar esta aplicación.</noscript>
    <div id="root"></div>
    
    <!-- SPA GitHub Pages redirect script -->
    <script type="text/javascript">
      // Single Page Apps for GitHub Pages
      // MIT License
      // https://github.com/rafgraph/spa-github-pages
      // This script checks to see if a redirect is present in the query string,
      // converts it back into the correct url and adds it to the
      // browser's history using window.history.replaceState(...),
      // which won't cause the browser to attempt to load the new url.
      // When the single page app is loaded further down in this file,
      // the correct url will be waiting in the browser's history for
      // the single page app to route accordingly.
      (function(l) {
        if (l.search[1] === '/' ) {
          var decoded = l.search.slice(1).split('&').map(function(s) { 
            return s.replace(/~and~/g, '&')
          }).join('?');
          window.history.replaceState(null, null,
              l.pathname.slice(0, -1) + decoded + l.hash
          );
        }
      }(window.location))
    </script>
    
    <!-- Additional redirect handling for direct URL access -->
    <script type="text/javascript">
      // Handle direct URL access for React Router
      (function() {
        var path = window.location.pathname;
        var basePath = '/travel-platform';
        
        // If we're not on the base path and not already redirected
        if (path !== basePath && path !== basePath + '/' && !window.location.search.includes('/?/')) {
          // Check if this is a valid route
          var validRoutes = ['/quiz', '/results', '/submit-masia', '/admin/login', '/admin/dashboard'];
          var currentRoute = path.replace(basePath, '');
          
          if (validRoutes.includes(currentRoute) || currentRoute.startsWith('/admin/')) {
            // This is a valid route, let React Router handle it
            return;
          }
        }
      })();
    </script>
  </body>
</html>
